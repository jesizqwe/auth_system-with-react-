<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task4</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg bg-white border-bottom mb-4">
        <div class="container-fluid app-container">
            <span class="navbar-brand">Task4</span>
            <div id="nav-auth-controls">
                <span id="current-user-name" class="me-3 text-muted small"></span>
                <button id="btn-logout" class="btn btn-outline-secondary btn-sm">Выйти</button>
            </div>
        </div>
    </nav>

    <main class="app-container">
        <div class="toast-container" id="toast-container"></div>

        <div id="react-dashboard-root"></div>
        
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        const logoutBtn = document.getElementById('btn-logout');
        const userNameSpan = document.getElementById('current-user-name');
        
        const user = JSON.parse(localStorage.getItem('currentUser'));
        if(user) userNameSpan.textContent = user.name;

        if (logoutBtn) {
            logoutBtn.onclick = async () => {
                try {
                    await fetch('/api/logout', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({ id: user?.id })
                    })
                } catch(e) {}
                localStorage.removeItem('currentUser');
                window.location.href = '/';
            }
        }
    </script>
    <script type="module" src="/dashboard-bundle.js"></script>
</body>
</html>